<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>Launching a Jupyter Instance on the UCLA Hoffman2 Cluster &#8211; In the Helix</title> <meta name="description" content="In the Helix is a place to post my thoughts on science and other things."> <meta name="keywords" content="Jupyter, Hoffman2"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="http://localhost:4000/assets/img/new_logo.png"> <meta name="twitter:title" content="Launching a Jupyter Instance on the UCLA Hoffman2 Cluster"> <meta name="twitter:description" content="Guide to launching a remote jupyter instance for interactive data analysis"> <meta name="twitter:site" content="@CpGenome"> <meta name="twitter:creator" content="@CpGenome"> <!-- Open Graph --> <meta property="og:locale" content="en_US"> <meta property="og:type" content="article"> <meta property="og:title" content="Launching a Jupyter Instance on the UCLA Hoffman2 Cluster"> <meta property="og:description" content="Guide to launching a remote jupyter instance for interactive data analysis"> <meta property="og:url" content="http://localhost:4000/JupyterLauncher/"> <meta property="og:site_name" content="In the Helix"> <meta property="og:image" content="http://localhost:4000/assets/img/new_logo.png"> <link rel="canonical" href="http://localhost:4000/JupyterLauncher/"> <link href="http://localhost:4000/feed.xml" type="application/atom+xml" rel="alternate" title="In the Helix Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="http://localhost:4000/assets/css/main.css"> <!-- JS --> <script src="http://localhost:4000/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="http://localhost:4000/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="http://localhost:4000/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="http://localhost:4000/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="http://localhost:4000/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="http://localhost:4000/favicon.png" /> <link rel="shortcut icon" href="http://localhost:4000/favicon.ico" /> <!-- Background Image --> <style type="text/css">body {background-image:url(http://localhost:4000/assets/img/background.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="http://localhost:4000/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="http://localhost:4000/assets/img/new_logo.png" alt="In the Helix photo" class="author-photo"> <h4>In the Helix</h4> <p>In the Helix is a place to post my thoughts on science and other things.</p> </li> <li><a href="http://localhost:4000/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="http://twitter.com/CpGenome" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-twitter-square"></i> Twitter</a> </li> <li> <a href="http://github.com/NuttyLogic" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul><!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="http://localhost:4000/posts/">All Posts</a></li> <li><a href="http://localhost:4000/tags/">All Tags</a></li> </ul> </li> <li><a href="http://localhost:4000/projects/" >Tools</a></li> <li><a href="http://localhost:4000/teaching/" >Teaching</a></li> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>Launching a Jupyter Instance on the UCLA Hoffman2 Cluster</h1> <h4>13 Jul 2018</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~2 minutes </p><!-- /.entry-reading-time --> <a class="btn zoombtn" href="http://localhost:4000/projects/"> <i class="fa fa-chevron-left"></i> </a> </div> <h1 id="interactive-programing-environment-for-analysis-of-genomic-data">Interactive Programing Environment for Analysis of Genomic Data</h1> <p><a href="http://jupyter.org/">Jupyter</a> provides an interactive programming environment that streamlines reproducible analysis of genomic data sets. Jupyter notebooks allow users to compartmentalize code and objects, take notes with markdown, and quickly visualize results. To effectively access data for analysis we want to work with a remote Jupyter instance that is running on the Hoffman2 cluster.</p> <p>Using jupyter on Hoffman2 requires some light setup. The get jupyter working on Hoffman2 you first have to set a password.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># connect to the cluster and enter your password</span>
ssh username@hoffman2.idre.ucla.edu

<span class="c"># load python</span>
module load python/3.6.1

<span class="c"># generate a config file</span>
jupyter notebook <span class="nt">--generate-config</span>

<span class="c"># set a jupyter password</span>
jupyter notebook password
Enter Password:
Verify Password:
</code></pre></div></div> <p>You are now ready to work with a remote instance of jupyter. To automate the connection process we will use a a python script, <a href="https://github.com/NuttyLogic/Hoffman2JupyterLauncher">Hoffman2JupyterLauncher.py</a>, that automates launching a remote jupyter notebook instance on the UCLA Hoffman2 cluster and forwarding the jupyter notebook port to your local machine. My version of the script is a refactored version a <a href="https://gitlab.idre.ucla.edu/dauria/jupyter-notebook">script</a> provided by the UCLA <a href="https://idre.ucla.edu/">IDRE</a>. This script will fail if the port forwarded is in use.</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>usage: python3 Hoffman2JupyterLauncher <span class="nt">-u</span> sge_username <span class="nt">-t</span> time_in_hours <span class="nt">-m</span> memory_in_GB
                                <span class="nt">-s</span> cores <span class="nt">-p</span> port <span class="nt">-d</span> jupyter_directory
                               <span class="nt">-c</span> cluster_address <span class="nt">-M</span> module1 <span class="nt">-M</span> module2 ...

Script to launch remote jupyter instances on Hoffman2

optional arguments:
  <span class="nt">-h</span>, <span class="nt">--help</span>  show this <span class="nb">help </span>message and <span class="nb">exit</span>
  <span class="nt">-u</span> U        Hoffman2 username
  <span class="nt">-t</span> T        <span class="nb">time </span><span class="k">in </span>hours, default <span class="o">=</span> 4
  <span class="nt">-m</span> M        memory <span class="k">in </span>GB per slot, default <span class="o">=</span> 4
  <span class="nt">-s</span> S        slots <span class="o">(</span>cores<span class="o">)</span>, default <span class="o">=</span> 2
  <span class="nt">-p</span> P        Port to output dictionary, default <span class="o">=</span> 8790
  <span class="nt">-d</span> D        Hoffman2 directory to initialize jupyter, default <span class="o">=</span> <span class="nv">$HOME</span>
  <span class="nt">-c</span> C        path to SGE cluster, default <span class="o">=</span> idre.ucla.edu
  <span class="nt">-M</span> M        <span class="nt">-M</span> <span class="k">for </span>each module you want to load, default python/3.6.1

</code></pre></div></div> <p>To run the script without specifying inputs, change the default values in the argument parser.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-u'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">'sge user'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'hoffman2 username'</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-t'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'time in hours, default = 4 '</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-m'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'memory in GB per slot, default = 4'</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-s'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'slots (cores), default = 2 '</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-p'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">8790</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'Port to output dictionary, default = 8790, '</span>
                                                       <span class="s">'if port is unavailable script will fail'</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-d'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">'$HOME'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'hoffman2 directory to initialize jupyter '</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-c'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s">'hoffman2.idre.ucla.edu'</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s">'path to SGE cluster'</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s">'-M'</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s">'python/3.6.1'</span><span class="p">],</span> <span class="n">action</span><span class="o">=</span><span class="s">'append'</span><span class="p">,</span>
                    <span class="n">help</span><span class="o">=</span><span class="s">'-M for each module you want to load'</span><span class="p">)</span>
</code></pre></div></div> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="http://localhost:4000/tags/#Jupyter" title="Pages tagged Jupyter" class="tag"><span class="term">Jupyter</span></a><a href="http://localhost:4000/tags/#Hoffman2" title="Pages tagged Hoffman2" class="tag"><span class="term">Hoffman2</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/JupyterLauncher/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=http://localhost:4000/JupyterLauncher/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=http://localhost:4000/JupyterLauncher/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> </div> </div> </header> <!-- JS --> <script src="http://localhost:4000/assets/js/jquery-1.12.0.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.dlmenu.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.goup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.magnific-popup.min.js"></script> <script src="http://localhost:4000/assets/js/jquery.fitvid.min.js"></script> <script src="http://localhost:4000/assets/js/scripts.js"></script> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
